<!--frontend/src/app/components/progress-tracker/progress-tracker.component.html-->
<!-- Add Navbar -->
<app-navbar></app-navbar>

<!-- Track Progress Page Navigation Menu -->
<nav class="dashboard-nav">
  <div class="nav-container">
    <div class="nav-menu">
      <a class="nav-item" routerLink="/dashboard" routerLinkActive="active">
        <i class="fas fa-home"></i>
        <span>Dashboard</span>
      </a>
      
      <a class="nav-item" routerLink="/topics" routerLinkActive="active">
        <i class="fas fa-book"></i>
        <span>Learn topics</span>
      </a>
      
      <a class="nav-item" routerLink="/voice-interview" routerLinkActive="active">
        <i class="fas fa-microphone"></i>
        <span>Take interviews</span>
      </a>
      
      <a class="nav-item" routerLink="/whiteboard" routerLinkActive="active">
        <i class="fas fa-palette"></i>
        <span>Whiteboard</span>
      </a>
    </div>
  </div>
</nav>

<div class="progress-tracker-container">
  <div class="progress-card">
    <!-- Header Section -->
    <div class="progress-header">
      <div class="header-content">
        <h1>
          <i class="fas fa-chart-line"></i>
          Your Progress Dashboard
        </h1>
        <p class="progress-subtitle">Track your learning journey and monitor your improvement over time</p>
      </div>
    </div>

    <div class="progress-content">
      <!-- Stats Overview -->
      <div class="stats-overview">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number">{{ userProgress?.totalSolved || 0 }}</div>
            <div class="stat-label">Problems Solved</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">{{ userProgress?.easySolved || 0 }}</div>
            <div class="stat-label">Easy</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">{{ userProgress?.mediumSolved || 0 }}</div>
            <div class="stat-label">Medium</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">{{ userProgress?.hardSolved || 0 }}</div>
            <div class="stat-label">Hard</div>
          </div>
        </div>
      </div>

      <!-- Progress Sections -->
      <div class="progress-sections">
        <!-- Daily Score Trend -->
        <div class="progress-section">
          <div class="section-header">
            <h3><i class="fas fa-calendar-day"></i>Daily Score Trend</h3>
          </div>
          <div class="daily-scores">
            <div *ngIf="userProgress?.dailyScores?.length > 0; else noScores">
              <div *ngFor="let score of userProgress.dailyScores" class="score-item">
                <span class="score-date">{{ score.date }}</span>
                <span class="score-value">{{ score.score }} points</span>
              </div>
            </div>
            <ng-template #noScores>
              <div class="no-scores">
                <i class="fas fa-chart-line fa-2x mb-2"></i>
                <p>No daily scores yet</p>
              </div>
            </ng-template>
          </div>
        </div>

        <!-- Problems by Difficulty -->
        <div class="progress-section">
          <div class="section-header">
            <h3><i class="fas fa-signal"></i>Problems by Difficulty</h3>
          </div>
          <div class="difficulty-progress">
            <div class="difficulty-item">
              <div class="difficulty-header">
                <span class="difficulty-name">Easy</span>
                <span class="difficulty-count easy">{{ userProgress?.easySolved || 0 }}</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-fill easy" 
                     [style.width]="(userProgress?.easySolved / userProgress?.totalSolved * 100) + '%'"></div>
              </div>
            </div>
            <div class="difficulty-item">
              <div class="difficulty-header">
                <span class="difficulty-name">Medium</span>
                <span class="difficulty-count medium">{{ userProgress?.mediumSolved || 0 }}</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-fill medium" 
                     [style.width]="(userProgress?.mediumSolved / userProgress?.totalSolved * 100) + '%'"></div>
              </div>
            </div>
            <div class="difficulty-item">
              <div class="difficulty-header">
                <span class="difficulty-name">Hard</span>
                <span class="difficulty-count hard">{{ userProgress?.hardSolved || 0 }}</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-fill hard" 
                     [style.width]="(userProgress?.hardSolved / userProgress?.totalSolved * 100) + '%'"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Bottom Sections -->
      <div class="bottom-sections">
        <!-- Recent Activities -->
        <div class="activity-card">
          <h4><i class="fas fa-clock-rotate-left"></i>Recent Activities</h4>
          <div class="activities-list">
            <div *ngIf="userProgress?.recentActivities?.length === 0; else activitiesList" class="no-activities">
              <i class="fas fa-inbox fa-2x mb-2"></i>
              <p>No recent activities</p>
            </div>
            <ng-template #activitiesList>
              <div *ngFor="let activity of userProgress?.recentActivities || []" class="activity-item">
                <div class="activity-icon" [class]="activity.type === 'solved' ? 'solved' : 'attempted'">
                  <i [class]="activity.type === 'solved' ? 'fas fa-check' : 'fas fa-redo'"></i>
                </div>
                <div class="activity-details">
                  <div class="activity-problem">{{ activity.problem }}</div>
                  <div class="activity-meta">{{ activity.difficulty }} â€¢ {{ activity.time }}</div>
                </div>
              </div>
            </ng-template>
          </div>
        </div>

        <!-- Leaderboard -->
        <div class="leaderboard-card">
          <h4><i class="fas fa-trophy"></i>Leaderboard</h4>
          <div class="table-responsive">
            <table class="leaderboard-table">
              <thead>
                <tr>
                  <th>Rank</th>
                  <th>User</th>
                  <th>Score</th>
                  <th>Solved</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let user of leaderboard" [class]="'rank-' + user.rank">
                  <td class="rank-cell">
                    <span *ngIf="user.rank <= 3">#{{ user.rank }}</span>
                    <span *ngIf="user.rank > 3">{{ user.rank }}</span>
                  </td>
                  <td class="user-cell" [class.you]="user.rank === 4">
                    <span>{{ user.username }}</span>
                  </td>
                  <td class="score-cell">{{ user.score }}</td>
                  <td class="solved-cell">{{ user.solved }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>